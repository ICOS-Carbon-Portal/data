@import akka.http.scaladsl.model.Uri
@import se.lu.nateko.cp.meta.core.crypto.Sha256Sum
@import se.lu.nateko.cp.meta.core.data.Envri
@import se.lu.nateko.cp.meta.core.HandleProxiesConfig
@import se.lu.nateko.cp.data.routes.LicenceRouting._

@(profile: LicenceProfile, loginUri: Option[Uri], handleProxies: HandleProxiesConfig)(implicit envri: Envri.Envri)

@template{
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://static.icos-cp.eu/constant/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<style>@LicenceStyle()</style>
}{
<div class="cp_page_container">

<div class="cp_page_header">
	<h1>@pageTitle</h1>
</div>

<div class="col_1">
  <div class="inner">
    <h4><img src="https://www.icos-cp.eu/sites/default/files/inline-images/creativecommons.png" style="margin-right:10px" />
			@name data is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 international licence</a></h4>
  </div>
</div>

	@licenceText

	@for(userLoginUri <- loginUri){
		<div class="col-sm-12 col-md-6 col-md-offset-3">
			<div class="link_box inner">
				<a href=@{userLoginUri} target="_blank"><h5>Log in to accept permanently</h5></a>
			</div>
		</div>
	}

	@profile match{
		case uris: UriLicenceProfile => {
			@for(licenceAcceptUri <- uris.licenceAcceptUri){
				@acceptLicence{
					@yesNoButtonsDiv{
						<a class="btn btn-primary btn-lg btn-licence" href=@{licenceAcceptUri}>Yes, I accept</a>
					}
				}
			}
		}
		case forms: FormLicenceProfile =>{
			@for(formInfo <- forms.formInfo){
				@acceptLicence{
					<form action="/objects" method="post">
						@for((name, value) <- formInfo){
							<input type="hidden" name="@name" value="@value" />
						}
						@yesNoButtonsDiv{
							<button class="btn btn-primary btn-lg btn-licence">Yes, I accept</button>
						}
					</form>
				}
			}
		}
	}

</div>

}

@licenceText = @{
	if(envri == Envri.SITES) LicenceSitesText() else LicenceIcosText(handleProxies)
}

@acceptLicence(yesNoButtons: Html) = {
	<div class="col-sm-6 col-md-4 col-md-offset-2">
		<div class="notice inner">
			<p>I hereby confirm that I have taken notice of the information provided to inform me about the data and good practices of data usage. These guidelines do not define additional contractual conditions.</p>
		</div>
	</div>

	<div class="col-sm-6 col-md-4">
		@yesNoButtons
	</div>
}

@yesNoButtonsDiv(yesButton: Html) = {
	<div class="buttons inner">
		@yesButton
		<a class="btn btn-default btn-lg btn-licence" href="javascript:window.history.go(-1);">Go back</a>
	</div>
}

@template = @{
	if(envri == Envri.SITES) SitesPage(pageTitle) _ else CpCommonPage(pageTitle) _
}

@pageTitle = @{
	if(envri == Envri.SITES) name + " Data Policy" else name + " Data Licence"
}

@name = @{
	envri
}
